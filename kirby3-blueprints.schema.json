{
  "$schema": "http://json-schema.org/draft/2020-12/schema",
  "$id": "https://getkirby.com/schema/blueprints.schema.json",
  "title": "JSON schema for Kirby 3 CMS blueprint files",
  "allOf": [
    {
      "type": "object",
      "properties": {
        "title": {
          "$ref": "#/$defs/stringOrTranslated"
        },
        "description": {
          "$ref": "#/$defs/stringOrTranslated"
        },
        "num": {
          "$ref": "#/$defs/nonEmptyString",
          "default": "zero"
        },
        "status": {
          "type": "object",
          "properties": {
            "draft": {
              "$ref": "#/$defs/stringOrLabelAndText"
            },
            "unlisted": {
              "$ref": "#/$defs/stringOrLabelAndText"
            },
            "listed": {
              "$ref": "#/$defs/stringOrLabelAndText"
            }
          }
        },
        "icon": {
          "$ref": "#/$defs/nonEmptyString"
        },
        "image": {
          "type": "object",
          "properties": {
            "back": {
              "$ref": "#/$defs/nonEmptyString"
            },
            "icon": {
              "$ref": "#/$defs/nonEmptyString"
            }
          }
        },
        "options": {
          "type": "object",
          "properties": {
            "changeSlug": {
              "$ref": "#/$defs/booleanOrObject"
            },
            "changeStatus": {
              "$ref": "#/$defs/booleanOrObject"
            },
            "changeTemplate": {
              "$ref": "#/$defs/booleanOrStringArrayUnique"
            },
            "changeTitle": {
              "$ref": "#/$defs/booleanOrObject"
            },
            "delete": {
              "$ref": "#/$defs/booleanOrObject"
            },
            "duplicate": {
              "$ref": "#/$defs/booleanOrObject"
            },
            "preview": {
              "$ref": "#/$defs/booleanOrString"
            },
            "read": {
              "$ref": "#/$defs/booleanOrObject"
            },
            "update": {
              "$ref": "#/$defs/booleanOrObject"
            },
            "changeName": {
              "$ref": "#/$defs/booleanOrObject"
            },
            "replace": {
              "$ref": "#/$defs/booleanOrObject"
            }
          }
        },
        "navigation": {
          "type": "object",
          "properties": {
            "status": {
              "$ref": "#/$defs/stringOrStringArrayUnique"
            },
            "template": {
              "$ref": "#/$defs/stringOrStringArrayUnique"
            },
            "sortBy": {
              "$ref": "#/$defs/stringOrStringArrayUnique"
            }
          }
        },
        "accept": {
          "oneOf": [
            {
              "$ref": "#/$defs/nonEmptyString"
            },
            {
              "type": "object",
              "properties": {
                "extension": {
                  "$ref": "#/$defs/stringOrStringArrayUnique"
                },
                "mime ": {
                  "$ref": "#/$defs/stringOrStringArrayUnique"
                },
                "maxheight": {
                  "$ref": "#/$defs/numberInPixel"
                },
                "maxsize": {
                  "$ref": "#/$defs/numberInBytes"
                },
                "maxwidth": {
                  "$ref": "#/$defs/numberInPixel"
                },
                "minheight": {
                  "$ref": "#/$defs/numberInPixel"
                },
                "minsize": {
                  "$ref": "#/$defs/numberInBytes"
                },
                "minwidth": {
                  "$ref": "#/$defs/numberInPixel"
                },
                "orientation": {
                  "$ref": "#/$defs/nonEmptyString"
                },
                "type": {
                  "$ref": "#/$defs/stringOrStringArrayUnique"
                }
              }
            }
          ]
        },
        "fields": {
          "$ref": "#/$defs/wrappers/fields"
        },
        "sections": {
          "$ref": "#/$defs/wrappers/sections"
        },
        "columns": {
          "$ref": "#/$defs/wrappers/columns"
        },
        "tabs": {
          "$ref": "#/$defs/wrappers/tabs"
        }
      }
    }
  ],
  "$defs": {
    "arrayOrBooleanOrNumberOrObjectOrString": {
      "oneOf": [
        {
          "$ref": "#/$defs/nonEmptyString"
        },
        {
          "type": "boolean"
        },
        {
          "type": "number"
        },
        {
          "type": "array"
        },
        {
          "type": "object"
        }
      ]
    },
    "nonEmptyString": {
      "type": "string",
      "minLength": 1
    },
    "notRequiredNonEmptyString": {
      "oneOf": [
        {
          "$ref": "#/$defs/nonEmptyString"
        },
        {
          "type": "null"
        }
      ]
    },
    "stringArrayUnique": {
      "type": "array",
      "uniqueItems": true,
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/nonEmptyString"
      }
    },
    "stringOrStringArrayUnique": {
      "oneOf": [
        {
          "$ref": "#/$defs/nonEmptyString"
        },
        {
          "$ref": "#/$defs/stringArrayUnique"
        }
      ]
    },
    "booleanOrString": {
      "oneOf": [
        {
          "type": "boolean"
        },
        {
          "type": "string"
        }
      ]
    },
    "booleanOrObject": {
      "oneOf": [
        {
          "type": "boolean"
        },
        {
          "type": "object"
        }
      ]
    },
    "booleanOrStringArrayUnique": {
      "oneOf": [
        {
          "type": "boolean"
        },
        {
          "$ref": "#/$defs/stringArrayUnique"
        }
      ]
    },
    "stringOrNumber": {
      "oneOf": [
        {
          "$ref": "#/$defs/nonEmptyString"
        },
        {
          "type": "number"
        }
      ]
    },
    "translated": {
      "type": "object",
      "properties": {
        "en": {
          "$ref": "#/$defs/nonEmptyString"
        },
        "de": {
          "$ref": "#/$defs/nonEmptyString"
        }
      }
    },
    "stringOrTranslated": {
      "oneOf": [
        {
          "$ref": "#/$defs/nonEmptyString"
        },
        {
          "$ref": "#/$defs/translated"
        }
      ]
    },
    "stringOrLabelAndText": {
      "oneOf": [
        {
          "$ref": "#/$defs/nonEmptyString"
        },
        {
          "type": "object",
          "properties": {
            "label": {
              "$ref": "#/$defs/nonEmptyString"
            },
            "text": {
              "$ref": "#/$defs/nonEmptyString"
            }
          }
        }
      ]
    },
    "numberInPixel": {
      "type": "number",
      "exclusiveMinimum": 0,
      "description": "in px"
    },
    "numberInBytes": {
      "type": "number",
      "exclusiveMinimum": 0,
      "description": "in bytes"
    },
    "fraction": {
      "$ref": "#/$defs/nonEmptyString"
    },
    "field": {
      "type": "object",
      "properties": {
        "label": {
          "$ref": "#/$defs/nonEmptyString"
        }
      }
    },
    "section": {
      "type": "object",
      "properties": {
        "sec-label": {
          "$ref": "#/$defs/nonEmptyString"
        }
      }
    },
    "column": {
      "properties": {
        "width": {
          "$ref": "#/$defs/fraction"
        },
        "fields": {
          "$ref": "#/$defs/wrappers/fields"
        },
        "sections": {
          "$ref": "#/$defs/wrappers/sections"
        }
      },
      "required": [
        "width"
      ],
      "patternProperties": {
        ".*": {
          "anyOf": [
            {
              "$ref": "#/$defs/section"
            }
          ]
        }
      }
    },
    "tab": {
      "type": "object",
      "properties": {
        "label": {
          "$ref": "#/$defs/nonEmptyString"
        },
        "fields": {
          "$ref": "#/$defs/wrappers/fields"
        },
        "sections": {
          "$ref": "#/$defs/wrappers/sections"
        },
        "columns": {
          "$ref": "#/$defs/wrappers/columns"
        }
      },
      "patternProperties": {
        ".*": {
          "anyOf": [
            {
              "$ref": "#/$defs/wrappers/fields"
            },
            {
              "$ref": "#/$defs/wrappers/sections"
            },
            {
              "$ref": "#/$defs/wrappers/columns"
            }
          ]
        }
      }
    },
    "field-properties": {
      "default": {
        "$ref": "#/$defs/arrayOrBooleanOrNumberOrObjectOrString",
        "description": "Default value for the field, which will be used when a page/file/user is created"
      },
      "extends": {
        "$ref": "#/$defs/nonEmptyString"
      },
      "help": {
        "$ref": "#/$defs/nonEmptyString",
        "description": "Optional help text below the field"
      },
      "label": {
        "$ref": "#/$defs/nonEmptyString"
      },
      "limit": {
        "type": "number",
        "exclusiveMinimum": 0
      },
      "multiple": {
        "type": "boolean",
        "default": true,
        "description": "If false, only a single one can be selected"
      },
      "theme": {
        "enum": ["none", "positive", "info", "negative"]
      }
    },
    "fields": {
      "files": {
        "required": [
          "type"
        ],
        "additionalProperties": false,
        "properties": {
          "type": {
            "enum": [
              "files"
            ]
          },
          "extends": {
            "$ref": "#/$defs/field-properties/extends"
          },
          "label": {
            "$ref": "#/$defs/field-properties/label"
          },
          "multiple": {
            "$ref": "#/$defs/field-properties/multiple"
          }
        }
      },
      "text": {
        "required": [
          "type"
        ],
        "additionalProperties": false,
        "properties": {
          "type": {
            "enum": [
              "text"
            ]
          },
          "extends": {
            "$ref": "#/$defs/field-properties/extends"
          },
          "default": {
            "$ref": "#/$defs/field-properties/default"
          },
          "label": {
            "$ref": "#/$defs/field-properties/label"
          },
          "help": {
            "$ref": "#/$defs/field-properties/help"
          }
        }
      }
    },
    "sections": {
      "info": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "enum": [
              "info"
            ]
          },
          "headline": {
            "$ref": "#/$defs/nonEmptyString",
            "description": "[deprecated] use label instead"
          },
          "label": {
            "$ref": "#/$defs/nonEmptyString"
          },
          "text": {
            "$ref": "#/$defs/nonEmptyString"
          },
          "theme": {
            "$ref": "#/$defs/field-properties/theme",
            "default": "info"
          }
        }
      },
      "fields": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "enum": [
              "fields"
            ]
          },
          "fields": {
            "$ref": "#/$defs/wrappers/fields"
          }
        }
      },
      "files": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "enum": [
              "files"
            ]
          }
        }
      },
      "pages": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "enum": [
              "pages"
            ]
          },
          "create": {
            "$ref": "#/$defs/field-properties/create"
          },
          "empty": {
            "$ref": "#/$defs/field-properties/empty"
          },
          "flip": {
            "$ref": "#/$defs/field-properties/flip",
            "default": false
          },
          "headline": {
            "$ref": "#/$defs/field-properties/headline"
          },
          "help": {
            "$ref": "#/$defs/field-properties/help"
          },
          "image": {
            "$ref": "#/$defs/field-properties/image"
          },
          "info": {
            "$ref": "#/$defs/field-properties/info"
          },
          "label": {
            "$ref": "#/$defs/field-properties/label"
          },
          "layout": {
            "$ref": "#/$defs/field-properties/layout",
            "default": "list"
          },
          "limit": {
            "$ref": "#/$defs/field-properties/limit",
            "default": 20
          },
          "max": {
            "$ref": "#/$defs/field-properties/max"
          },
          "min": {
            "$ref": "#/$defs/field-properties/min"
          },
          "page": {
            "$ref": "#/$defs/field-properties/page"
          },
          "parent": {
            "$ref": "#/$defs/field-properties/parent"
          },
          "size": {
            "$ref": "#/$defs/field-properties/size",
            "default": "auto"
          },
          "sortBy": {
            "$ref": "#/$defs/field-properties/sortBy"
          },
          "sortable": {
            "$ref": "#/$defs/field-properties/sortable",
            "default": true
          },
          "status": {
            "$ref": "#/$defs/field-properties/status"
          },
          "templates": {
            "$ref": "#/$defs/field-properties/templates"
          },
          "text": {
            "$ref": "#/$defs/nonEmptyString",
            "default": "'{{ page.title }}'"
          }
        }
      }
    },
    "wrappers": {
      "fields": {
        "type": "object",
        "properties": {
          "legal": {
            "type": "boolean"
          }
        },
        "patternProperties": {
          ".*": {
            "anyOf": [
              {
                "$ref": "#/$defs/nonEmptyString",
                "description": "shorthand of extends property"
              },
              {
                "$ref": "#/$defs/fields/text"
              },
              {
                "$ref": "#/$defs/fields/files"
              }
            ]
          }
        }
      },
      "sections": {
        "type": "object",
        "patternProperties": {
          ".*": {
            "anyOf": [
              {
                "$ref": "#/$defs/sections/info"
              },
              {
                "$ref": "#/$defs/sections/fields"
              },
              {
                "$ref": "#/$defs/sections/files"
              },
              {
                "$ref": "#/$defs/sections/pages"
              }
            ]
          }
        }
      },
      "columns": {
        "type": "object",
        "patternProperties": {
          ".*": {
            "$ref": "#/$defs/column"
          }
        }
      },
      "tabs": {
        "type": "object",
        "patternProperties": {
          ".*": {
            "$ref": "#/$defs/tab"
          }
        }
      }
    }
  }
}
